<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <!-- favicon and web app manifest -->
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="favicon.svg">
    <meta name="theme-color" content="#2c3e50">
    <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ù…Ø§Ø²Ù† - Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    
    <style>
        :root { --primary: #007bff; --success: #28a745; --danger: #dc3545; --dark: #2c3e50; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #eef2f7; margin: 0; padding: 0; }
        
        .admin-wrapper { display: flex; min-height: 100vh; }
        
        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
        .sidebar { 
            width: 250px; 
            background: #2c3e50; 
            padding: 20px 0; 
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            right: 0;
            display: none; /* Ù…Ø®ÙÙŠØ© Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ */
        }
        
        .sidebar h3 { 
            color: white; 
            padding: 0 20px 15px; 
            margin: 0 0 10px 0;
            border-bottom: 2px solid rgba(255,255,255,0.1);
            font-size: 1.1rem;
        }
        
        .sidebar-item { 
            padding: 12px 20px; 
            color: #bdc3c7; 
            cursor: pointer; 
            transition: all 0.3s;
            border-right: 3px solid transparent;
            font-weight: 500;
        }
        
        .sidebar-item:hover { 
            background: rgba(255,255,255,0.1); 
            color: white;
            padding-right: 18px;
        }
        
        .sidebar-item.active { 
            background: var(--primary);
            color: white;
            border-right: 3px solid #fff;
        }
        
        .admin-container { 
            flex: 1; 
            margin-right: 250px;
            padding: 20px;
            max-width: 1200px;
        }
        
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 20px; border-top: 5px solid var(--primary); display: none; }
        .card.active { display: block; }
        
        h2 { color: var(--dark); border-bottom: 2px solid #eee; padding-bottom: 10px; }
        .input-group { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 15px; }
        input, select { flex: 1; min-width: 200px; padding: 12px; border: 1px solid #ddd; border-radius: 8px; }
        
        button { cursor: pointer; border: none; padding: 12px 20px; border-radius: 8px; font-weight: bold; transition: 0.3s; }
        .btn-main { background: var(--primary); color: white; width: 100%; margin-top: 10px; }
        .btn-main:hover { opacity: 0.9; }
        
        /* ØªØµÙ…ÙŠÙ… Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        .product-item { display: flex; align-items: center; background: #fff; padding: 10px; border-radius: 8px; margin-bottom: 10px; border-right: 5px solid var(--success); box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .product-item img { width: 60px; height: 60px; object-fit: cover; border-radius: 5px; margin-left: 15px; }
        .product-info { flex-grow: 1; }
        .actions { display: flex; gap: 5px; }
        .btn-edit { background: #ffc107; color: #000; }
        .btn-delete { background: var(--danger); color: white; }
        
        h1 { margin: 0 0 20px 0; color: var(--dark); }
        
        @media (max-width: 768px) {
            .sidebar { width: 100%; position: static; height: auto; }
            .admin-wrapper { flex-direction: column; }
            .admin-container { margin-right: 0; }
        }
    </style>
</head>
<body>

<div class="admin-wrapper">
    <!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© -->
    <div class="sidebar">
        <h3>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h3>
        <div class="sidebar-item" onclick="window.open('index.html', '_blank')">ğŸŒ Ø§Ù„Ù…ÙˆÙ‚Ø¹</div>
        <div class="sidebar-item active" onclick="showSection('slider')">ğŸ–¼ï¸ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¹Ø±Ø¶</div>
        <div class="sidebar-item" onclick="showSection('logo')">ğŸ”§ Ù„ÙˆØ¬Ùˆ Ø§Ù„Ù…ÙˆÙ‚Ø¹</div>
        <div class="sidebar-item" onclick="showSection('tutorials')">ğŸ“š Ø§Ù„Ø¯Ø±ÙˆØ³</div>
        <div class="sidebar-item" onclick="showSection('products')">ğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
        <div class="sidebar-item" onclick="showSection('users')">ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</div>
    </div>

    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <div class="admin-container">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
            <h1 style="margin:0;">ğŸ›  Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ù…Ø§Ø²Ù† (Ø§Ù„Ø£Ø¯Ù…Ù†)</h1>
            <button onclick="logoutUser()" id="logoutBtn" class="btn-main" style="display:none; background:#dc3545; width:auto; padding:10px 20px;">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
        </div>

    <!-- Login Card -->
    <div class="card" id="loginCard" style="max-width:400px; margin:100px auto; display:block;">
        <h2 style="text-align:center; margin-bottom:20px;">ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
        <div class="input-group" style="flex-direction:column;">
            <input type="text" id="loginUser" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" style="width:100%;" onkeypress="if(event.key==='Enter') loginUser()">
            <input type="password" id="loginPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="width:100%;" onkeypress="if(event.key==='Enter') loginUser()">
            <button onclick="loginUser()" class="btn-main" style="width:100%; background:var(--primary);">Ø¯Ø®ÙˆÙ„</button>
        </div>
        <p style="text-align:center; color:#666; font-size:0.9rem; margin-top:15px;">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø¶Ø§ÙØ© ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…</p>
    </div>

    <div id="adminControls" style="display:none;">
    <div class="card" id="slider">
        <h2>ğŸ–¼ï¸ Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¹Ø±Ø¶ (Slider)</h2>
        <p style="font-size: 0.9rem; color: #666;">ØªØºÙŠÙŠØ± Ø§Ù„Ø¹Ù†ÙˆØ§Ù†ØŒ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©ØŒ ÙˆØ¥Ø¯Ø§Ø±Ø© ØµÙˆØ± Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø±</p>
        <div class="input-group">
            <input type="text" id="sliderTitle" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¸Ø§Ù‡Ø± Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØ±Ø©">
            <input type="text" id="sliderImg" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ø®Ù„ÙÙŠØ© (URL)">
        </div>
        <div style="margin-top:12px; display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
            <input type="file" id="sliderFiles" accept="image/*" multiple onchange="handleSliderFiles(event)">
            <button class="btn-main" style="width:auto; padding:8px 14px;" onclick="uploadSliderFiles()">Ø£Ø±ÙÙ‚ ØµÙˆØ± Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø±</button>
        </div>
        <div id="sliderPreview" style="margin-top:10px; display:flex; gap:8px; align-items:center; flex-wrap:wrap;"></div>
        <div style="margin-top:10px; display:flex; gap:10px;">
            <button onclick="updateSlider()" class="btn-main">ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</button>
            <button onclick="clearSliderPreview()" class="btn-main" style="background:#6c757d; width:auto;">Ù…Ø³Ø­ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø§Øª</button>
        </div>

        <div style="margin-top:14px;">
            <h3 style="margin:0 0 8px 0;">ØµÙˆØ± Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h3>
            <div id="sliderImagesList" style="display:flex; gap:8px; flex-wrap:wrap;"></div>
        </div>
    </div>

    <div class="card" id="logo">
        <h2>ğŸ”§ Ù„ÙˆØ¬Ùˆ Ø§Ù„Ù…ÙˆÙ‚Ø¹</h2>
        <p style="font-size:0.95rem;color:#666;">Ø§Ø±ÙØ¹ ØµÙˆØ±Ø© Ù„ÙˆØ¬Ùˆ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù‡Ù†Ø§ ÙˆØ³ÙŠØªÙ… Ø­ÙØ¸Ù‡Ø§ ÙˆØ¹Ø±Ø¶Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©.</p>
        <div class="input-group" style="align-items:center;">
            <input type="file" id="logoFile" accept="image/*" onchange="handleLogoFile(event)">
            <img id="logoPreview" src="" alt="Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù„ÙˆØ¬Ùˆ" style="height:60px; margin-inline-start:10px; border-radius:6px; display:none;">
        </div>
        <button class="btn-main" onclick="saveLogo()" style="background:var(--primary);">Ø­ÙØ¸ Ø§Ù„Ù„ÙˆØ¬Ùˆ</button>
    </div>

    <div class="card" id="tutorials">
        <h2 id="tutorialFormTitle">ğŸ“š Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯Ø±ÙˆØ³</h2>
        <p style="font-size:0.95rem;color:#666;">Ø£Ø¶Ù Ø¯Ø±ÙˆØ³Ø§Ù‹ Ù„ÙŠØªÙ… Ø¹Ø±Ø¶Ù‡Ø§ ÙÙŠ Ù…Ø±ÙƒØ² Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª. Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Markdown.</p>
        <div class="input-group" style="flex-direction:column;">
            <input type="hidden" id="editTutorialId">
            <input id="adminTTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ø±Ø³">
            <div style="display:flex;gap:8px;margin-top:8px"></div>
            <div style="margin-top:8px;display:flex;align-items:center;gap:10px;">
                <input type="file" id="adminTThumb" accept="image/*" onchange="handleTutorialThumb(event)">
                <img id="tutorialThumbPreview" src="" alt="Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ±Ø©" style="height:60px;border-radius:6px;display:none;">
            </div>
            <textarea id="adminTContent" rows="6" placeholder="Ø§Ù„Ù…Ø­ØªÙˆÙ‰ (Markdown)"></textarea>
            <div style="display:flex;gap:8px;margin-top:8px;">
                <button class="btn-main" onclick="adminAddTutorial()" style="background:var(--primary);">Ø£Ø¶Ù Ø¯Ø±Ø³</button>
                <button class="btn-main" onclick="adminClearTutorialForm()" style="background:#6c757d;">Ù…Ø³Ø­</button>
            </div>
        </div>

        <div style="margin-top:30px; border-top:2px solid #eee; padding-top:20px;">
            <h3 style="margin:0 0 15px 0;">ğŸ“‹ Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h3>
            <div id="adminTutorialsList"></div>
        </div>
    </div>

    <div class="card" id="products">
    <h2 id="formTitle">ğŸ“¦ Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</h2>
    <input type="hidden" id="editId">
    <div class="input-group">
        <input type="text" id="pName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
        <select id="pCategory">
            <option value="iphone"> iphone</option>
            <option value="Samsung">Samsung</option>
            <option value="Go">Go</option>
        </select>
        <input type="hidden" id="pImg">
    </div>
    <div style="margin-top:10px; display:none;">
        <label for="pStorage" style="display:block; font-weight:600; margin-bottom:6px;">Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø³Ø¹Ø© (JSON)</label>
        <textarea id="pStorage" rows="4" placeholder='Ù…Ø«Ø§Ù„: [{"label":"128GB","price":6100,"priceWholesale":6150,"priceOffer":5850},{"label":"256GB","price":6600,"priceWholesale":6650,"priceOffer":6350}]' style="width:100%; padding:8px; border-radius:8px; border:1px solid #ddd;"></textarea>
        <small style="color:#666; display:block; margin-top:6px;">Ø§ØªØ±Ùƒ Ø§Ù„Ø­Ù‚Ù„ ÙØ§Ø±ØºÙ‹Ø§ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© (128/256/512)</small>
        <div style="margin-top:8px; display:flex; gap:8px;">
            <button type="button" id="addStorageBtn" class="btn-main" style="background:#17a2b8; padding:8px 12px; width:auto;">Ø¥Ø¶Ø§ÙØ© Ø³Ø¹Ø©</button>
            <button type="button" id="clearStorageBtn" class="btn-main" style="background:#6c757d; padding:8px 12px; width:auto;" onclick="clearStorageList()">Ù…Ø³Ø­ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…</button>
        </div>

        <div id="storageForm" style="display:none; margin-top:10px; background:#fff; padding:10px; border-radius:8px;">
            <div style="display:flex; gap:8px; flex-wrap:wrap;">
                <input id="storageLabel" placeholder="Ù…Ø«Ø§Ù„: 128GB" style="flex:1; min-width:120px; padding:8px; border:1px solid #ddd; border-radius:6px;">
                <input id="storagePrice" type="number" placeholder="Ø³Ø¹Ø± ÙƒÙˆØ§Ø±Ø§ Ù…ÙˆØ±Ø§" style="width:160px; padding:8px; border:1px solid #ddd; border-radius:6px;">
                <input id="storagePriceWholesale" type="number" placeholder="ØªØ§Ø¨ÙŠ ØªÙ…Ø§Ø±Ø§" style="width:160px; padding:8px; border:1px solid #ddd; border-radius:6px;">
                <input id="storagePriceOffer" type="number" placeholder="Ø³Ø¹Ø± Ø§Ù„ÙƒØ§Ø´" style="width:160px; padding:8px; border:1px solid #ddd; border-radius:6px;">
            </div>
            <div style="margin-top:8px; display:flex; gap:8px;">
                <button type="button" id="addStorageConfirm" class="btn-main" style="background:#28a745;">Ø£Ø¶Ù</button>
                <button type="button" id="addStorageCancel" class="btn-main" style="background:#dc3545;">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>

        <div id="storageList" style="margin-top:10px;"></div>
    </div>

    <div style="margin-top:20px; border-top:2px solid #eee; padding-top:15px;">
        <label style="display:block; font-weight:600; margin-bottom:10px;">ğŸ¨ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù†</label>
        <small style="color:#666; display:block; margin-bottom:10px;">Ø£Ø¶Ù Ø£Ù„ÙˆØ§Ù† Ù…Ø®ØªÙ„ÙØ© Ù„Ù„Ù…Ù†ØªØ¬ Ù…Ø¹ Ø³Ø¹Ø± ÙˆØµÙˆØ±Ø© Ø®Ø§ØµØ© Ù„ÙƒÙ„ Ù„ÙˆÙ†</small>
        
        <div style="margin-top:8px; display:flex; gap:8px;">
            <button type="button" id="addColorBtn" class="btn-main" style="background:#6f42c1; padding:8px 12px; width:auto;">Ø¥Ø¶Ø§ÙØ© Ù„ÙˆÙ†</button>
            <button type="button" id="clearColorsBtn" class="btn-main" style="background:#6c757d; padding:8px 12px; width:auto;" onclick="clearColorsList()">Ù…Ø³Ø­ Ø§Ù„Ø£Ù„ÙˆØ§Ù†</button>
        </div>

        <div id="colorForm" style="display:none; margin-top:15px; background:#f8f9fa; padding:15px; border-radius:8px; border:2px solid #6f42c1;">
            <h4 style="margin:0 0 10px 0; color:#6f42c1;">Ø¥Ø¶Ø§ÙØ© Ù„ÙˆÙ† Ø¬Ø¯ÙŠØ¯</h4>
            <div style="display:flex; gap:8px; flex-wrap:wrap; margin-bottom:10px;">
                <input id="colorName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„ÙˆÙ† (Ù…Ø«Ø§Ù„: Ø£Ø³ÙˆØ¯ØŒ Ø£Ø¨ÙŠØ¶ØŒ Ø£Ø²Ø±Ù‚)" style="flex:1; min-width:200px; padding:8px; border:1px solid #ddd; border-radius:6px;">
                <input id="colorCode" type="color" value="#000000" style="width:60px; height:40px; border:1px solid #ddd; border-radius:6px; cursor:pointer;">
            </div>
            <div style="display:flex; gap:8px; flex-wrap:wrap; margin-bottom:10px;">
                <input id="colorPrice" type="number" placeholder="Ø³Ø¹Ø± ÙƒÙˆØ§Ø±Ø§ Ù…ÙˆØ±Ø§" style="width:160px; padding:8px; border:1px solid #ddd; border-radius:6px;">
                <input id="colorPriceWholesale" type="number" placeholder="ØªØ§Ø¨ÙŠ ØªÙ…Ø§Ø±Ø§" style="width:160px; padding:8px; border:1px solid #ddd; border-radius:6px;">
                <input id="colorPriceOffer" type="number" placeholder="Ø³Ø¹Ø± Ø§Ù„ÙƒØ§Ø´" style="width:160px; padding:8px; border:1px solid #ddd; border-radius:6px;" onchange="calculateColorPrices()">
            </div>
            <div style="margin-top:10px; background:#fff; padding:10px; border-radius:8px; border:1px solid #e6e6e6;">
                <label style="display:block; font-weight:600; margin-bottom:8px;">Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø³Ø¹Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ù„ÙˆÙ†</label>
                <div style="display:flex; gap:8px; flex-wrap:wrap;">
                    <button type="button" id="addColorStorageBtn" class="btn-main" style="background:#17a2b8; padding:6px 10px; width:auto;">Ø¥Ø¶Ø§ÙØ© Ø³Ø¹Ø©</button>
                    <button type="button" id="clearColorStorageBtn" class="btn-main" style="background:#6c757d; padding:6px 10px; width:auto;" onclick="clearColorStorageList()">Ù…Ø³Ø­ Ø§Ù„Ø³Ø¹Ø§Øª</button>
                </div>

                <div id="colorStorageForm" style="display:none; margin-top:10px; background:#f9f9f9; padding:10px; border-radius:8px;">
                    <div style="display:flex; gap:8px; flex-wrap:wrap;">
                        <input id="colorStorageLabel" placeholder="Ù…Ø«Ø§Ù„: 128GB" style="flex:1; min-width:120px; padding:8px; border:1px solid #ddd; border-radius:6px;">
                        <input id="colorStoragePrice" type="number" placeholder="Ø³Ø¹Ø± ÙƒÙˆØ§Ø±Ø§ Ù…ÙˆØ±Ø§" style="width:160px; padding:8px; border:1px solid #ddd; border-radius:6px;">
                        <input id="colorStoragePriceWholesale" type="number" placeholder="ØªØ§Ø¨ÙŠ ØªÙ…Ø§Ø±Ø§" style="width:160px; padding:8px; border:1px solid #ddd; border-radius:6px;">
                        <input id="colorStoragePriceOffer" type="number" placeholder="Ø³Ø¹Ø± Ø§Ù„ÙƒØ§Ø´" style="width:160px; padding:8px; border:1px solid #ddd; border-radius:6px;" onchange="calculateColorStoragePrices()">
                    </div>
                    <div style="margin-top:8px; display:flex; gap:8px;">
                        <button type="button" id="addColorStorageConfirm" class="btn-main" style="background:#28a745;">Ø£Ø¶Ù</button>
                        <button type="button" id="addColorStorageCancel" class="btn-main" style="background:#dc3545;">Ø¥Ù„ØºØ§Ø¡</button>
                    </div>
                </div>

                <div id="colorStorageList" style="margin-top:10px;"></div>
            </div>
            <div style="margin-bottom:10px;">
                <label style="display:block; margin-bottom:5px; font-weight:500;">ØµÙˆØ±Ø© Ø§Ù„Ù„ÙˆÙ†:</label>
                <input type="file" id="colorImage" accept="image/*" style="padding:5px;">
                <img id="colorImagePreview" src="" alt="Ù…Ø¹Ø§ÙŠÙ†Ø©" style="height:80px; margin-top:8px; border-radius:6px; display:none;">
            </div>
            <div style="margin-top:10px; display:flex; gap:8px;">
                <button type="button" id="addColorConfirm" class="btn-main" style="background:#28a745;">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù„ÙˆÙ†</button>
                <button type="button" id="addColorCancel" class="btn-main" style="background:#dc3545;">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>

        <div id="colorsList" style="margin-top:15px;"></div>
    </div>

    <!-- Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø£ØµØ¨Ø­Øª Ù…Ù†Ø³ÙˆØ¨Ø© ÙÙ‚Ø· Ø¥Ù„Ù‰ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø£Ùˆ Ø§Ù„Ø³Ø¹Ø§Øª (Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ø¹Ø§Ø± Ø¹Ø§Ù…Ø© Ù„Ù„Ù…Ù†ØªØ¬) -->
    <button onclick="saveProduct()" id="saveBtn" class="btn-main" style="background: var(--success);">Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬</button>
    <button onclick="resetForm()" id="cancelBtn" style="display:none; background:#6c757d; color:white; width:100%; margin-top:5px;">Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„</button>

    <div style="margin-top:30px; border-top:2px solid #eee; padding-top:20px;">
        <h3 style="margin:0 0 15px 0;">ğŸ“‹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h3>
        <div id="adminProductsList"></div>
    </div>
</div>

    <div class="card" id="users">
        <h2 id="userFormTitle">ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h2>
        <p style="font-size:0.95rem;color:#666;">Ø£Ø¶Ù Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¬Ø¯Ø¯ ÙˆØ­Ø¯Ø¯ ØµÙ„Ø§Ø­ÙŠØ§ØªÙ‡Ù… ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</p>
        <div class="input-group" style="flex-direction:column;">
            <input type="hidden" id="editUserId">
            <input id="userName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
            <input id="userPassword" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
            <input id="userEmail" type="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
            
            <div style="margin-top:15px; background:#f8f9fa; padding:15px; border-radius:8px;">
                <h4 style="margin:0 0 10px 0; color:#2c3e50;">ğŸ” Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª:</h4>
                <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:10px;">
                    <label style="display:flex; align-items:center; gap:8px; cursor:pointer;">
                        <input type="checkbox" class="user-permission" value="slider" checked>
                        <span>ğŸ–¼ï¸ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¹Ø±Ø¶</span>
                    </label>
                    <label style="display:flex; align-items:center; gap:8px; cursor:pointer;">
                        <input type="checkbox" class="user-permission" value="logo" checked>
                        <span>ğŸ”§ Ù„ÙˆØ¬Ùˆ Ø§Ù„Ù…ÙˆÙ‚Ø¹</span>
                    </label>
                    <label style="display:flex; align-items:center; gap:8px; cursor:pointer;">
                        <input type="checkbox" class="user-permission" value="tutorials" checked>
                        <span>ğŸ“š Ø§Ù„Ø¯Ø±ÙˆØ³</span>
                    </label>
                    <label style="display:flex; align-items:center; gap:8px; cursor:pointer;">
                        <input type="checkbox" class="user-permission" value="products" checked>
                        <span>ğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</span>
                    </label>
                    <label style="display:flex; align-items:center; gap:8px; cursor:pointer;">
                        <input type="checkbox" class="user-permission" value="users">
                        <span>ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</span>
                    </label>
                </div>
            </div>
            
            <div style="display:flex;gap:8px;margin-top:15px;">
                <button class="btn-main" onclick="saveUser()" id="saveUserBtn" style="background:var(--primary);">Ø­ÙØ¸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</button>
                <button class="btn-main" onclick="clearUserForm()" style="background:#6c757d;">Ù…Ø³Ø­</button>
            </div>
        </div>

        <div style="margin-top:30px; border-top:2px solid #eee; padding-top:20px;">
            <h3 style="margin:0 0 15px 0;">ğŸ“‹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø­Ø§Ù„ÙŠÙŠÙ†</h3>
            <div id="usersList"></div>
        </div>
    </div>

    </div> <!-- end adminControls -->
    </div> <!-- end admin-container -->
</div> <!-- end admin-wrapper -->

<footer style="background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%); color: white; text-align: center; padding: 15px 20px; margin-top: 30px; border-top: 3px solid #667eea;">
    <div style="max-width: 1200px; margin: 0 auto;">
        <p style="margin: 5px 0; font-size: 0.95rem; font-weight: 600;">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â© 2026</p>
        <p style="margin: 5px 0; font-size: 0.9rem; opacity: 0.9;">mazenalgarne</p>
    </div>
</footer>

<script>
    // --- ØªÙƒÙˆÙŠÙ† Firebase Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ ---
    // Ø§Ù†Ø³Ø® Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù…Ù† Firebase Console ÙˆØ¶Ø¹Ù‡Ø§ Ù‡Ù†Ø§
  const firebaseConfig = {
        apiKey: "AIzaSyDdLB3KHZVbNw3O9QrKJzBw2pL_pFn8Iso",
        databaseURL: "https://mazen-2ba04-default-rtdb.firebaseio.com",
        projectId: "mazen-2ba04"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    // --- Admin auth helpers (with client-side hashing) ---
    async function hashString(str) {
        const enc = new TextEncoder();
        const data = enc.encode(str);
        const hashBuf = await crypto.subtle.digest('SHA-256', data);
        const hashArray = Array.from(new Uint8Array(hashBuf));
        return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    }

    let currentUser = null;
    let userPermissions = [];

    async function loginUser() {
        const username = (document.getElementById('loginUser').value || '').trim();
        const password = (document.getElementById('loginPass').value || '').trim();
        
        if (!username || !password) {
            alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±');
            return;
        }

        try {
            const hashedPassword = await hashString(password);
            
            // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
            const usersSnapshot = await db.ref('admin/users').once('value');
            const users = usersSnapshot.val();
            
            if (!users) {
                alert('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…');
                return;
            }

            let foundUser = null;
            let userId = null;

            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            for (const [id, user] of Object.entries(users)) {
                if (user.username === username && user.password === hashedPassword) {
                    foundUser = user;
                    userId = id;
                    break;
                }
            }

            if (foundUser) {
                // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù†Ø§Ø¬Ø­
                currentUser = { id: userId, ...foundUser };
                userPermissions = foundUser.permissions || [];
                
                localStorage.setItem('adminLoggedIn', '1');
                localStorage.setItem('currentUserId', userId);
                localStorage.setItem('currentUserName', username);
                
                showAdminControls(true);
                applyUserPermissions();
                alert('Ù…Ø±Ø­Ø¨Ø§Ù‹ ' + username + '!');
            } else {
                alert('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
            }
        } catch (err) {
            alert('Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„: ' + err.message);
        }
    }

    function applyUserPermissions() {
        // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©
        document.querySelectorAll('.sidebar-item').forEach(item => {
            const onclick = item.getAttribute('onclick');
            if (onclick && onclick.includes('showSection')) {
                const sectionMatch = onclick.match(/showSection\('(\w+)'\)/);
                if (sectionMatch) {
                    const section = sectionMatch[1];
                    // Ø¥Ø¸Ù‡Ø§Ø± ÙÙ‚Ø· Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù…ØµØ±Ø­ Ø¨Ù‡Ø§
                    if (!userPermissions.includes(section)) {
                        item.style.display = 'none';
                    } else {
                        item.style.display = '';
                    }
                }
            }
        });
        
        // Ø¥Ø¸Ù‡Ø§Ø± Ø£ÙˆÙ„ Ù‚Ø³Ù… Ù…ØªØ§Ø­
        const firstAvailableSection = userPermissions[0];
        if (firstAvailableSection) {
            showSection(firstAvailableSection);
        }
    }

    function showAdminControls(show) {
        const loginCard = document.getElementById('loginCard');
        const adminControls = document.getElementById('adminControls');
        const logoutBtn = document.getElementById('logoutBtn');
        const sidebar = document.querySelector('.sidebar');
        
        if (loginCard) loginCard.style.display = show ? 'none' : 'block';
        if (adminControls) adminControls.style.display = show ? 'block' : 'none';
        if (logoutBtn) logoutBtn.style.display = show ? 'inline-block' : 'none';
        if (sidebar) sidebar.style.display = show ? 'block' : 'none';
    }

    function logoutUser() {
        if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')) {
            localStorage.removeItem('adminLoggedIn');
            localStorage.removeItem('currentUserId');
            localStorage.removeItem('currentUserName');
            currentUser = null;
            userPermissions = [];
            showAdminControls(false);
            document.getElementById('loginUser').value = '';
            document.getElementById('loginPass').value = '';
        }
    }

    // ÙØ­Øµ Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    async function checkLoginStatus() {
        const isLoggedIn = localStorage.getItem('adminLoggedIn');
        const userId = localStorage.getItem('currentUserId');
        
        if (isLoggedIn === '1' && userId) {
            try {
                const userSnapshot = await db.ref('admin/users/' + userId).once('value');
                const user = userSnapshot.val();
                
                if (user) {
                    currentUser = { id: userId, ...user };
                    userPermissions = user.permissions || [];
                    showAdminControls(true);
                    applyUserPermissions();
                } else {
                    // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø­Ø°ÙˆÙ
                    localStorage.removeItem('adminLoggedIn');
                    localStorage.removeItem('currentUserId');
                    localStorage.removeItem('currentUserName');
                    showAdminControls(false);
                }
            } catch (err) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ÙØ­Øµ Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:', err);
                showAdminControls(false);
            }
        } else {
            showAdminControls(false);
        }
    }

    // Ø¯Ø§Ù„Ø© Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
    function showSection(sectionId) {
        // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
        const cards = document.querySelectorAll('.card');
        cards.forEach(card => card.classList.remove('active'));
        
        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø·Ø© Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©
        const sidebarItems = document.querySelectorAll('.sidebar-item');
        sidebarItems.forEach(item => item.classList.remove('active'));
        
        // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ø­Ø¯Ø¯
        const targetCard = document.getElementById(sectionId);
        if(targetCard) {
            targetCard.classList.add('active');
        }
        
        // ØªÙ†Ø´ÙŠØ· Ø¹Ù†ØµØ± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨
        sidebarItems.forEach(item => {
            const onclick = item.getAttribute('onclick');
            if (onclick && onclick.includes(`'${sectionId}'`)) {
                item.classList.add('active');
            }
        });
    }

    // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©ØŒ ÙØ­Øµ Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    document.addEventListener('DOMContentLoaded', () => {
        checkLoginStatus();
    });

    // Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø© Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø© Ù„Ø¥Ø¬Ø¨Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
    window.addEventListener('beforeunload', () => {
        localStorage.removeItem('adminLoggedIn');
        localStorage.removeItem('currentUserId');
        localStorage.removeItem('currentUserName');
    });


    async function loginAdmin() {
        const user = document.getElementById('adminUser').value;
        const pass = document.getElementById('adminPass').value;
        if(!user || !pass) { alert('Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±'); return; }
        const hashed = await hashString(pass);
        db.ref('admin/credentials').once('value').then(snap => {
            const cred = snap.val();
            if(cred && cred.user === user) {
                // Support both hashed and legacy-plaintext storage
                if(cred.pass === hashed || cred.pass === pass) {
                    localStorage.setItem('adminLoggedIn','1');
                    showAdminControls(true);
                    alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„');
                    return;
                }
            }
            alert('Ø®Ø·Ø£ ÙÙŠ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±');
        }).catch(err => { alert('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: ' + err.message); });
    }

    async function setCredentials() {
        const user = document.getElementById('newAdminUser').value.trim();
        const pass = document.getElementById('newAdminPass').value;
        if(!user || !pass) { alert('Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¬Ø¯ÙŠØ¯ÙŠÙ†'); return; }
        const hashed = await hashString(pass);
        db.ref('admin/credentials').set({ user, pass: hashed })
        .then(() => alert('ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„'))
        .catch(err => alert('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸: ' + err.message));
    }

    function logoutAdmin() {
        localStorage.removeItem('adminLoggedIn');
        showAdminControls(false);
        alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬');
    }

    // show all admin controls by default (login handled on separate setup page)
    document.addEventListener('DOMContentLoaded', () => {
        showAdminControls(true);

        // Ù…Ù„Ø§Ø­Ø¸Ø©: Ù„Ù… ÙŠØ¹Ø¯ Ù‡Ù†Ø§Ùƒ Ø­Ù‚Ù„ Ø³Ø¹Ø± Ø¹Ø§Ù… Ù„Ù„Ù…Ù†ØªØ¬. Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ØªØ£ØªÙŠ Ø§Ù„Ø¢Ù† Ù…Ù† Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø£Ùˆ Ø§Ù„Ø³Ø¹Ø§Øª.
    });

    // 1. ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø±
    function updateSlider() {
        const title = document.getElementById('sliderTitle').value;
        const img = document.getElementById('sliderImg').value;
        if(title && img) {
            db.ref('homepage/slider').set({ title, img })
            .then(() => alert("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø¨Ù†Ø¬Ø§Ø­!"));
        } else { alert("ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø±"); }
    }
    // client-side storage options array (for building JSON)
    window.currentStorageOptions = [];
    
    // client-side colors array
    window.currentColors = [];
    let currentColorImageData = null;
    let currentColorStorageOptions = [];
    let editingColorIndex = -1;

    // storage UI handlers
    const addBtn = document.getElementById('addStorageBtn');
    const storageForm = document.getElementById('storageForm');
    const addConfirm = document.getElementById('addStorageConfirm');
    const addCancel = document.getElementById('addStorageCancel');
    const storageListEl = document.getElementById('storageList');

    if(addBtn) addBtn.addEventListener('click', () => { storageForm.style.display = storageForm.style.display === 'none' ? 'block' : 'none'; });
    if(addCancel) addCancel.addEventListener('click', () => { storageForm.style.display = 'none'; clearStorageInputs(); });
    if(addConfirm) addConfirm.addEventListener('click', () => {
        const lbl = (document.getElementById('storageLabel').value || '').trim();
        const sp = Number(document.getElementById('storagePrice').value || 0);
        const sw = Number(document.getElementById('storagePriceWholesale').value || 0);
        const so = Number(document.getElementById('storagePriceOffer').value || 0);
        if(!lbl) { alert('Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø³Ø¹Ø©'); return; }
        window.currentStorageOptions.push({ label: lbl, price: sp, priceWholesale: sw, priceOffer: so });
        renderStorageList();
        syncTextarea();
        clearStorageInputs();
        storageForm.style.display = 'none';
    });

    function clearStorageInputs(){ document.getElementById('storageLabel').value=''; document.getElementById('storagePrice').value=''; document.getElementById('storagePriceWholesale').value=''; document.getElementById('storagePriceOffer').value=''; }

    function renderStorageList(){
        if(!storageListEl) return;
        if(!window.currentStorageOptions || !window.currentStorageOptions.length){ storageListEl.innerHTML = '<small style="color:#666">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø®ÙŠØ§Ø±Ø§Øª Ø³Ø¹Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</small>'; return; }
        storageListEl.innerHTML = '';
        window.currentStorageOptions.forEach((s, idx) => {
            const div = document.createElement('div');
            div.style.display = 'flex'; div.style.justifyContent = 'space-between'; div.style.alignItems = 'center'; div.style.background = '#fff'; div.style.padding = '8px'; div.style.borderRadius = '8px'; div.style.marginBottom = '6px';
            div.innerHTML = `<div><strong>${s.label}</strong> â€” ${s.price} Ø±ÙŠÙ€Ø§Ù„ | ${s.priceWholesale} | ${s.priceOffer}</div><div><button type=\"button\" onclick=\"removeStorage(${idx})\" style=\"background:#dc3545;color:#fff;border:none;padding:6px 8px;border-radius:6px;\">Ø­Ø°Ù</button></div>`;
            storageListEl.appendChild(div);
        });
    }

    window.removeStorage = function(i){ window.currentStorageOptions.splice(i,1); renderStorageList(); syncTextarea(); }

    window.clearStorageList = function(){ if(confirm('Ù…Ø³Ø­ ÙƒÙ„ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø³Ø¹Ø©ØŸ')){ window.currentStorageOptions = []; renderStorageList(); syncTextarea(); } }

    function syncTextarea(){ const ta = document.getElementById('pStorage'); if(ta) ta.value = JSON.stringify(window.currentStorageOptions); }

    // render init
    renderStorageList();

    // === Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ ===
    window.calculateColorPrices = function() {
        const cashPrice = Number(document.getElementById('colorPriceOffer').value || 0);
        if (cashPrice > 0) {
            const kowaraPrice = Math.round(cashPrice + 400);
            const tabiPrice = Math.round(cashPrice * 1.07);
            document.getElementById('colorPrice').value = kowaraPrice;
            document.getElementById('colorPriceWholesale').value = tabiPrice;
        }
    };

    window.calculateColorStoragePrices = function() {
        const cashPrice = Number(document.getElementById('colorStoragePriceOffer').value || 0);
        if (cashPrice > 0) {
            const kowaraPrice = Math.round(cashPrice + 400);
            const tabiPrice = Math.round(cashPrice * 1.07);
            document.getElementById('colorStoragePrice').value = kowaraPrice;
            document.getElementById('colorStoragePriceWholesale').value = tabiPrice;
        }
    };

    // === Colors management ===
    const addColorBtn = document.getElementById('addColorBtn');
    const colorForm = document.getElementById('colorForm');
    const addColorConfirm = document.getElementById('addColorConfirm');
    const addColorCancel = document.getElementById('addColorCancel');
    const colorsListEl = document.getElementById('colorsList');
    const colorImageInput = document.getElementById('colorImage');
    const colorImagePreview = document.getElementById('colorImagePreview');
    const addColorStorageBtn = document.getElementById('addColorStorageBtn');
    const clearColorStorageBtn = document.getElementById('clearColorStorageBtn');
    const colorStorageForm = document.getElementById('colorStorageForm');
    const addColorStorageConfirm = document.getElementById('addColorStorageConfirm');
    const addColorStorageCancel = document.getElementById('addColorStorageCancel');
    const colorStorageListEl = document.getElementById('colorStorageList');

    if(addColorBtn) addColorBtn.addEventListener('click', () => {
        colorForm.style.display = colorForm.style.display === 'none' ? 'block' : 'none';
    });

    if(addColorCancel) addColorCancel.addEventListener('click', () => {
        colorForm.style.display = 'none';
        editingColorIndex = -1;
        clearColorInputs();
    });

    if(addColorStorageBtn) addColorStorageBtn.addEventListener('click', () => {
        if(!colorStorageForm) return;
        colorStorageForm.style.display = colorStorageForm.style.display === 'none' ? 'block' : 'none';
    });

    if(addColorStorageCancel) addColorStorageCancel.addEventListener('click', () => {
        if(colorStorageForm) colorStorageForm.style.display = 'none';
        clearColorStorageInputs();
    });

    if(addColorStorageConfirm) addColorStorageConfirm.addEventListener('click', () => {
        const lbl = (document.getElementById('colorStorageLabel').value || '').trim();
        const sp = Number(document.getElementById('colorStoragePrice').value || 0);
        const sw = Number(document.getElementById('colorStoragePriceWholesale').value || 0);
        const so = Number(document.getElementById('colorStoragePriceOffer').value || 0);
        if(!lbl) { alert('Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø³Ø¹Ø©'); return; }
        currentColorStorageOptions.push({ label: lbl, price: sp, priceWholesale: sw, priceOffer: so });
        renderColorStorageList();
        clearColorStorageInputs();
        if(colorStorageForm) colorStorageForm.style.display = 'none';
    });

    if(colorImageInput) colorImageInput.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if(!file) return;
        if(!file.type.startsWith('image/')) {
            alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù ØµÙˆØ±Ø©.');
            return;
        }
        const reader = new FileReader();
        reader.onload = function(ev) {
            currentColorImageData = ev.target.result;
            colorImagePreview.src = currentColorImageData;
            colorImagePreview.style.display = 'inline-block';
        };
        reader.readAsDataURL(file);
    });

    if(addColorConfirm) addColorConfirm.addEventListener('click', () => {
        const name = (document.getElementById('colorName').value || '').trim();
        const code = document.getElementById('colorCode').value;
        const price = Number(document.getElementById('colorPrice').value || 0);
        const priceWholesale = Number(document.getElementById('colorPriceWholesale').value || 0);
        const priceOffer = Number(document.getElementById('colorPriceOffer').value || 0);
        
        if(!name) {
            alert('Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù„ÙˆÙ†');
            return;
        }
        
        if(!currentColorImageData && editingColorIndex === -1) {
            alert('ÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ù„Ù„ÙˆÙ†');
            return;
        }

        if(!currentColorStorageOptions.length) {
            alert('Ø£Ø¶Ù Ø³Ø¹Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù„ÙˆÙ†');
            return;
        }
        
        const colorObj = {
            name: name,
            code: code,
            price: price,
            priceWholesale: priceWholesale,
            priceOffer: priceOffer,
            image: currentColorImageData || (editingColorIndex !== -1 ? window.currentColors[editingColorIndex].image : null),
            storageOptions: currentColorStorageOptions.map(o => ({
                label: o.label,
                price: Number(o.price||0),
                priceWholesale: Number(o.priceWholesale||0),
                priceOffer: Number(o.priceOffer||0)
            }))
        };
        
        if(editingColorIndex !== -1) {
            window.currentColors[editingColorIndex] = colorObj;
            editingColorIndex = -1;
        } else {
            window.currentColors.push(colorObj);
        }
        
        renderColorsList();
        clearColorInputs();
        colorForm.style.display = 'none';
    });

    function clearColorInputs() {
        document.getElementById('colorName').value = '';
        document.getElementById('colorCode').value = '#000000';
        document.getElementById('colorPrice').value = '';
        document.getElementById('colorPriceWholesale').value = '';
        document.getElementById('colorPriceOffer').value = '';
        document.getElementById('colorImage').value = '';
        colorImagePreview.src = '';
        colorImagePreview.style.display = 'none';
        currentColorImageData = null;
        currentColorStorageOptions = [];
        renderColorStorageList();
        clearColorStorageInputs();
        editingColorIndex = -1;
        const btn = document.getElementById('addColorConfirm');
        if(btn) btn.innerText = 'Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù„ÙˆÙ†';
    }

    function clearColorStorageInputs() {
        const l = document.getElementById('colorStorageLabel');
        const p = document.getElementById('colorStoragePrice');
        const w = document.getElementById('colorStoragePriceWholesale');
        const o = document.getElementById('colorStoragePriceOffer');
        if(l) l.value = '';
        if(p) p.value = '';
        if(w) w.value = '';
        if(o) o.value = '';
    }

    function renderColorStorageList() {
        if(!colorStorageListEl) return;
        if(!currentColorStorageOptions.length) {
            colorStorageListEl.innerHTML = '<small style="color:#666">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¹Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ù„ÙˆÙ†</small>';
            return;
        }
        colorStorageListEl.innerHTML = '';
        currentColorStorageOptions.forEach((s, idx) => {
            const div = document.createElement('div');
            div.style.display = 'flex';
            div.style.justifyContent = 'space-between';
            div.style.alignItems = 'center';
            div.style.background = '#fff';
            div.style.padding = '8px';
            div.style.borderRadius = '8px';
            div.style.marginBottom = '6px';
            div.innerHTML = `<div><strong>${s.label}</strong> â€” ${s.price} | ${s.priceWholesale} | ${s.priceOffer}</div><div><button type=\"button\" onclick=\"removeColorStorage(${idx})\" style=\"background:#dc3545;color:#fff;border:none;padding:6px 8px;border-radius:6px;\">Ø­Ø°Ù</button></div>`;
            colorStorageListEl.appendChild(div);
        });
    }

    window.removeColorStorage = function(i) {
        currentColorStorageOptions.splice(i,1);
        renderColorStorageList();
    }

    window.clearColorStorageList = function() {
        if(confirm('Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø³Ø¹Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ù„ÙˆÙ†ØŸ')) {
            currentColorStorageOptions = [];
            renderColorStorageList();
        }
    }

    function renderColorsList() {
        if(!colorsListEl) return;
        if(!window.currentColors || !window.currentColors.length) {
            colorsListEl.innerHTML = '<small style="color:#666">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù„ÙˆØ§Ù† Ø­Ø§Ù„ÙŠØ§Ù‹</small>';
            return;
        }
        colorsListEl.innerHTML = '';
        window.currentColors.forEach((color, idx) => {
            const div = document.createElement('div');
            div.style.display = 'flex';
            div.style.alignItems = 'center';
            div.style.background = '#fff';
            div.style.padding = '10px';
            div.style.borderRadius = '8px';
            div.style.marginBottom = '8px';
            div.style.border = '2px solid ' + color.code;
            div.innerHTML = `
                <img src="${color.image}" style="width:60px; height:60px; object-fit:cover; border-radius:6px; margin-left:10px;">
                <div style="flex:1;">
                    <div style="display:flex; align-items:center; gap:8px; margin-bottom:4px;">
                        <strong>${color.name}</strong>
                        <div style="width:30px; height:30px; background:${color.code}; border-radius:50%; border:2px solid #ddd;"></div>
                    </div>
                    <small style="color:#666;">
                        ÙƒÙˆØ§Ø±Ø§ Ù…ÙˆØ±Ø§: ${color.price} | ØªØ§Ø¨ÙŠ ØªÙ…Ø§Ø±Ø§: ${color.priceWholesale} | ÙƒØ§Ø´: ${color.priceOffer}
                        ${color.storageOptions && color.storageOptions.length ? ` | Ø³Ø¹Ø§Øª: ${color.storageOptions.length}` : ''}
                    </small>
                </div>
                <div style="display:flex; gap:5px;">
                    <button type="button" onclick="editColor(${idx})" style="background:#ffc107; color:#000; border:none; padding:6px 10px; border-radius:6px; cursor:pointer; font-weight:600;">ØªØ¹Ø¯ÙŠÙ„</button>
                    <button type="button" onclick="removeColor(${idx})" style="background:#dc3545; color:#fff; border:none; padding:6px 10px; border-radius:6px; cursor:pointer;">Ø­Ø°Ù</button>
                </div>
            `;
            colorsListEl.appendChild(div);
        });
    }

    window.editColor = function(idx) {
        if(idx < 0 || idx >= window.currentColors.length) return;
        editingColorIndex = idx;
        const color = window.currentColors[idx];
        
        document.getElementById('colorName').value = color.name || '';
        document.getElementById('colorCode').value = color.code || '#000000';
        document.getElementById('colorPrice').value = color.price || '';
        document.getElementById('colorPriceWholesale').value = color.priceWholesale || '';
        document.getElementById('colorPriceOffer').value = color.priceOffer || '';
        
        if(color.image) {
            currentColorImageData = color.image;
            colorImagePreview.src = color.image;
            colorImagePreview.style.display = 'inline-block';
        }
        
        currentColorStorageOptions = Array.isArray(color.storageOptions) ? color.storageOptions.map(o => ({
            label: o.label,
            price: Number(o.price||0),
            priceWholesale: Number(o.priceWholesale||0),
            priceOffer: Number(o.priceOffer||0)
        })) : [];
        renderColorStorageList();
        
        const btn = document.getElementById('addColorConfirm');
        if(btn) btn.innerText = 'Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª';
        colorForm.style.display = 'block';
        window.scrollTo(0, colorForm.offsetTop);
    };

    window.removeColor = function(idx) {
        if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù„ÙˆÙ†ØŸ')) {
            window.currentColors.splice(idx, 1);
            renderColorsList();
        }
    };

    window.clearColorsList = function() {
        if(confirm('Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø£Ù„ÙˆØ§Ù†ØŸ')) {
            window.currentColors = [];
            renderColorsList();
        }
    };

    // render init colors
    renderColorsList();

    // 2. Ø­ÙØ¸ (Ø¥Ø¶Ø§ÙØ© Ø£Ùˆ ØªØ¹Ø¯ÙŠÙ„) Ù…Ù†ØªØ¬
   function saveProduct() {
    const id = document.getElementById('editId').value;
    const name = (document.getElementById('pName').value || '').trim();
    const img = (document.getElementById('pImg').value || '').trim();
    const category = (document.getElementById('pCategory').value || '').trim();

    const missing = [];
    if(!name) missing.push('Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬');
    if(!category) missing.push('Ø§Ù„ØªØµÙ†ÙŠÙ');

    if(missing.length) {
        alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„ØªØ§Ù„ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸:\n- ' + missing.join('\n- '));
        return;
    }

    const productData = { name, img, category };

    // read storage options JSON if provided
    const storageText = (document.getElementById('pStorage').value || '').trim();
    if(storageText) {
        try {
            const parsed = JSON.parse(storageText);
            if(Array.isArray(parsed)) productData.storageOptions = parsed.map(o => ({ label: o.label, price: Number(o.price||0), priceWholesale: Number(o.priceWholesale||0), priceOffer: Number(o.priceOffer||0) }));
            else alert('Ø­Ù‚Ù„ Ø§Ù„Ø³Ø¹Ø§Øª ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…ØµÙÙˆÙØ© JSON');
        } catch(err) {
            alert('Ø®Ø·Ø£ ÙÙŠ ØªÙ†Ø³ÙŠÙ‚ JSON Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ø³Ø¹Ø§Øª: ' + err.message);
            return;
        }
    }

    // Add colors if available
    if(window.currentColors && window.currentColors.length > 0) {
        // Normalize colors: ensure numeric prices and storage options
        productData.colors = window.currentColors.map(c => ({
            name: c.name || '',
            code: c.code || '#000000',
            price: Number(c.price || 0),
            priceWholesale: Number(c.priceWholesale || 0),
            priceOffer: Number(c.priceOffer || 0),
            image: c.image || '',
            storageOptions: Array.isArray(c.storageOptions) ? c.storageOptions.map(o => ({ label: o.label, price: Number(o.price||0), priceWholesale: Number(o.priceWholesale||0), priceOffer: Number(o.priceOffer||0) })) : []
        }));
        if(!productData.img && productData.colors[0] && productData.colors[0].image) {
            productData.img = productData.colors[0].image;
        }
    }

    // Validation: prices must be provided inside storage options or colors
    function hasValidPrices(pd) {
        if(pd.storageOptions && pd.storageOptions.length) {
            return pd.storageOptions.every(o => isFinite(Number(o.price)) && isFinite(Number(o.priceWholesale)) && isFinite(Number(o.priceOffer)));
        }
        if(pd.colors && pd.colors.length) {
            for(const c of pd.colors) {
                if(isFinite(Number(c.price)) && isFinite(Number(c.priceWholesale)) && isFinite(Number(c.priceOffer))) return true;
                if(c.storageOptions && c.storageOptions.length && c.storageOptions.every(o => isFinite(Number(o.price)) && isFinite(Number(o.priceWholesale)) && isFinite(Number(o.priceOffer)))) return true;
            }
        }
        return false;
    }

    if(!hasValidPrices(productData)) {
        alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø¯Ø§Ø®Ù„ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø£Ùˆ Ø¯Ø§Ø®Ù„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³Ø¹Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸.');
        return;
    }

    if(!productData.img) {
        alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© ØµÙˆØ±Ø© Ù„Ù„ÙˆÙ† Ø£Ùˆ ØµÙˆØ±Ø© Ù„Ù„Ù…Ù†ØªØ¬');
        return;
    }

    if(id) db.ref('homepage/products/' + id).update(productData);
    else db.ref('homepage/products').push(productData);
    resetForm();
}

    // 3. Ø­Ø°Ù Ù…Ù†ØªØ¬
    function deleteProduct(id) {
        if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ")) {
            db.ref('homepage/products/' + id).remove();
        }
    }

    // Ø¯Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„
    function loadProductForEdit(id, encodedData) {
        try {
                const p = JSON.parse(decodeURIComponent(encodedData));
                editProduct(id, p.name, p.img, p.category, p.storageOptions, p.colors);
        } catch(e) {
            alert('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬: ' + e.message);
        }
    }

    // 4. ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„
    function editProduct(id, name, img, cat, storageOptions, colors) {
        document.getElementById('editId').value = id;
        document.getElementById('pName').value = name;
        // Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ØªÙØ¯Ø§Ø± Ø¶Ù…Ù† Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø£Ùˆ Ø§Ù„Ø³Ø¹Ø§Øª â€” Ù„Ø§ Ù†Ø¹ÙŠÙ‘Ù† Ø³Ø¹Ø±Ù‹Ø§ Ø¹Ø§Ù…Ù‘Ù‹Ø§ Ù‡Ù†Ø§
        document.getElementById('pImg').value = img;
        document.getElementById('pCategory').value = cat;
        // populate storage JSON if available
        try {
            if(storageOptions){
                document.getElementById('pStorage').value = JSON.stringify(storageOptions, null, 2);
                // also populate working array and render list
                window.currentStorageOptions = Array.isArray(storageOptions) ? storageOptions.map(o => ({ label: o.label, price: Number(o.price||0), priceWholesale: Number(o.priceWholesale||0), priceOffer: Number(o.priceOffer||0) })) : [];
                renderStorageList();
            } else { document.getElementById('pStorage').value = ''; window.currentStorageOptions = []; renderStorageList(); }
        } catch(e) { document.getElementById('pStorage').value = ''; }

        // populate colors if available
        try {
            if(colors && Array.isArray(colors)){
                window.currentColors = colors.map(c => ({
                    name: c.name || '',
                    code: c.code || '#000000',
                    price: Number(c.price||0),
                    priceWholesale: Number(c.priceWholesale||0),
                    priceOffer: Number(c.priceOffer||0),
                    image: c.image || '',
                    storageOptions: Array.isArray(c.storageOptions) ? c.storageOptions.map(o => ({
                        label: o.label,
                        price: Number(o.price||0),
                        priceWholesale: Number(o.priceWholesale||0),
                        priceOffer: Number(o.priceOffer||0)
                    })) : []
                }));
                renderColorsList();
            } else { window.currentColors = []; renderColorsList(); }
        } catch(e) { window.currentColors = []; renderColorsList(); }

        document.getElementById('formTitle').innerText = "âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ Ø­Ø§Ù„ÙŠØ§Ù‹";
        document.getElementById('saveBtn').innerText = "Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª";
        document.getElementById('saveBtn').style.background = "#ffc107";
        document.getElementById('cancelBtn').style.display = "block";
        window.scrollTo(0,0);
    }

    function resetForm() {
        document.getElementById('editId').value = '';
        document.getElementById('pName').value = '';
        document.getElementById('pImg').value = '';
        const cat = document.getElementById('pCategory');
        if(cat) cat.value = 'Ø¹Ø§Ù…';
        // Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ù‚ÙˆÙ„ Ø£Ø³Ø¹Ø§Ø± Ø¹Ø§Ù…Ø©Ø› Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ù…Ø­ÙÙˆØ¸Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø£Ùˆ Ø§Ù„Ø³Ø¹Ø§Øª
        document.getElementById('pStorage').value = '';
        window.currentStorageOptions = [];
        renderStorageList();
        window.currentColors = [];
        renderColorsList();
        editingColorIndex = -1;
        const colorBtn = document.getElementById('addColorConfirm');
        if(colorBtn) colorBtn.innerText = 'Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù„ÙˆÙ†';
        document.getElementById('formTitle').innerText = "ğŸ“¦ Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯";
        const saveBtn = document.getElementById('saveBtn');
        if(saveBtn) { saveBtn.innerText = 'Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬'; saveBtn.style.background = 'var(--success)'; }
        const cancelBtn = document.getElementById('cancelBtn');
        if(cancelBtn) cancelBtn.style.display = 'none';
    }

    // 5. Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø´ÙƒÙ„ Ù„Ø­Ø¸ÙŠ
    db.ref('homepage/products').on('value', (snap) => {
        const listDiv = document.getElementById('adminProductsList');
        if (!listDiv) return;
        const fragment = document.createDocumentFragment();
        const tempDiv = document.createElement('div');
        snap.forEach((child) => {
            const p = child.val();
            const id = child.key;
            const encoded = encodeURIComponent(JSON.stringify(p));
            tempDiv.innerHTML = `
                <div class="product-item">
                    <img src="${p.img}" onerror="this.src='https://via.placeholder.com/60'">
                    <div class="product-info">
                        <strong>${p.name}</strong> <br>
                        <small>${p.price} Ø±ÙŠØ§Ù„ | ${p.category}</small>
                    </div>
                    <div class="actions">
                        <button class="btn-edit" onclick="loadProductForEdit('${id}', '${encoded}')">ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="btn-delete" onclick="deleteProduct('${id}')">Ø­Ø°Ù</button>
                    </div>
                </div>`;
            fragment.appendChild(tempDiv.firstElementChild);
        });
        listDiv.innerHTML = '';
        listDiv.appendChild(fragment);
    });

    // 6. Ù„ÙˆØ¬Ùˆ Ø§Ù„Ù…ÙˆÙ‚Ø¹ - Ù…Ø¹Ø§ÙŠÙ†Ø© ÙˆØ­ÙØ¸
    let logoDataURL = null;
    function handleLogoFile(e) {
        const file = e.target.files[0];
        if(!file) return;
        if(!file.type.startsWith('image/')) { alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù ØµÙˆØ±Ø©.'); return; }
        const reader = new FileReader();
        reader.onload = function(ev) {
            logoDataURL = ev.target.result;
            const img = document.getElementById('logoPreview');
            img.src = logoDataURL;
            img.style.display = 'inline-block';
        }
        reader.readAsDataURL(file);
    }

    function saveLogo() {
        if(!logoDataURL) { alert('Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ø£ÙˆÙ„Ø§Ù‹'); return; }
        const name = (document.getElementById('logoFile').files[0] || {}).name || 'logo';
        db.ref('homepage/logo').set({ data: logoDataURL, name })
        .then(() => alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù„ÙˆØ¬Ùˆ Ø¨Ù†Ø¬Ø§Ø­'))
        .catch((err) => alert('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸: ' + err.message));
    }

    /* ---------- Ø¥Ø¶Ø§ÙØ©: Ø±ÙØ¹ ÙˆØ¥Ø¯Ø§Ø±Ø© ØµÙˆØ± Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± ---------- */
    let sliderFilesData = [];

    function handleSliderFiles(e) {
        const files = Array.from(e.target.files || []);
        const preview = document.getElementById('sliderPreview');
        if(!preview) return;
        files.forEach(file => {
            if(!file.type.startsWith('image/')) return;
            const reader = new FileReader();
            reader.onload = function(ev) {
                sliderFilesData.push({ name: file.name, data: ev.target.result });
                const img = document.createElement('img');
                img.src = ev.target.result;
                img.style.height = '60px'; img.style.borderRadius = '6px'; img.style.objectFit = 'cover';
                preview.appendChild(img);
            };
            reader.readAsDataURL(file);
        });
    }

    function clearSliderPreview() {
        sliderFilesData = [];
        const preview = document.getElementById('sliderPreview'); if(preview) preview.innerHTML = '';
        const inp = document.getElementById('sliderFiles'); if(inp) inp.value = '';
    }

    function uploadSliderFiles() {
        if(!sliderFilesData.length) { alert('Ø§Ø®ØªØ± Ù…Ù„ÙØ§Øª ØµÙˆØ±Ø© Ø£ÙˆÙ„Ø§Ù‹'); return; }
        const pushes = [];
        sliderFilesData.forEach(item => {
            const ref = db.ref('homepage/slider/images').push();
            pushes.push(ref.set({ data: item.data, name: item.name, createdAt: Date.now() }));
        });
        Promise.all(pushes).then(() => {
            // ØªØ¹ÙŠÙŠÙ† Ø£ÙˆÙ„ ØµÙˆØ±Ø© Ù…Ø±ÙÙˆØ¹Ø© ÙƒØµÙˆØ±Ø© Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Ø¥Ù† ÙˆÙØ¬Ø¯ Ø¹Ù†ÙˆØ§Ù†)
            const title = document.getElementById('sliderTitle').value || '';
            db.ref('homepage/slider').update({ img: sliderFilesData[0].data, title })
            .then(() => {
                alert('ØªÙ… Ø±ÙØ¹ ØµÙˆØ± Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± ÙˆØªØ¹ÙŠÙŠÙ† Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©');
                clearSliderPreview();
                loadSliderImages();
            });
        }).catch(err => alert('Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø±ÙØ¹: ' + err.message));
    }

    function loadSliderImages() {
        const list = document.getElementById('sliderImagesList');
        if(!list) return;
        db.ref('homepage/slider/images').on('value', snap => {
            const val = snap.val();
            if(!val) { list.innerHTML = '<small style="color:#666">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ± Ø­Ø§Ù„ÙŠØ§Ù‹</small>'; return; }
            const fragment = document.createDocumentFragment();
            // Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹
            Object.keys(val).reverse().forEach(key => {
                const it = val[key];
                const wrapper = document.createElement('div');
                wrapper.style.position = 'relative'; wrapper.style.display = 'inline-block'; wrapper.style.margin = '6px';
                const img = document.createElement('img'); img.src = it.data; img.style.height='80px'; img.style.width='120px'; img.style.objectFit='cover'; img.style.borderRadius='6px';
                const del = document.createElement('button'); del.innerText = 'Ø­Ø°Ù'; del.style.position='absolute'; del.style.right='4px'; del.style.top='4px'; del.style.padding='4px 6px'; del.style.background='#dc3545'; del.style.color='#fff'; del.style.border='none'; del.style.borderRadius='4px';
                del.onclick = () => { if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„ØµÙˆØ±Ø©ØŸ')) db.ref('homepage/slider/images/' + key).remove(); };
                const setMain = document.createElement('button'); setMain.innerText = 'ØªØ¹ÙŠÙŠÙ† Ø±Ø¦ÙŠØ³ÙŠØ©'; setMain.style.position='absolute'; setMain.style.left='4px'; setMain.style.bottom='4px'; setMain.style.padding='4px 6px'; setMain.style.background='#007bff'; setMain.style.color='#fff'; setMain.style.border='none'; setMain.style.borderRadius='4px';
                setMain.onclick = () => { db.ref('homepage/slider').update({ img: it.data }).then(()=>alert('ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©')); };
                wrapper.appendChild(img); wrapper.appendChild(del); wrapper.appendChild(setMain);
                fragment.appendChild(wrapper);
            });
            list.innerHTML = '';
            list.appendChild(fragment);
        });
    }

    // Initial load of slider images when admin opens page
    loadSliderImages();

    // Ø¹Ø±Ø¶ Ø£ÙŠ Ù„ÙˆØ¬Ùˆ Ù…Ø­ÙÙˆØ¸ Ø¹Ù†Ø¯ ÙØªØ­ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
    db.ref('homepage/logo').on('value', (snap) => {
        const v = snap.val();
        if(v && v.data) {
            const img = document.getElementById('logoPreview');
            img.src = v.data;
            img.style.display = 'inline-block';
        }
    });

    // Ù…Ø¹Ø§Ù„Ø¬ Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„Ø¯Ø±Ø³ Ø§Ù„Ù…ØµØºØ±Ø©
    let tutorialThumbDataURL = null;
    function handleTutorialThumb(e) {
        const file = e.target.files[0];
        if(!file) return;
        if(!file.type.startsWith('image/')) { alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù ØµÙˆØ±Ø©.'); return; }
        const reader = new FileReader();
        reader.onload = function(ev) {
            tutorialThumbDataURL = ev.target.result;
            const img = document.getElementById('tutorialThumbPreview');
            img.src = tutorialThumbDataURL;
            img.style.display = 'inline-block';
        }
        reader.readAsDataURL(file);
    }

    // Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ø¯Ø±ÙˆØ³ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Ø¨Ø¯ÙˆÙ† Ù‚ÙŠÙˆØ¯)
    function adminAddTutorial(){
        const editId = document.getElementById('editTutorialId').value;
        const title = (document.getElementById('adminTTitle').value || '').trim();
        const content = (document.getElementById('adminTContent').value || '').trim();
        if(!title){ alert('Ø§Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ø±Ø³'); return; }
        
        const data = { title, content };
        // Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø© Ø¥Ù† ÙˆÙØ¬Ø¯ØªØŒ ÙˆØ¥Ù„Ø§ Ø§Ø­ØªÙØ¸ Ø¨Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
        if(tutorialThumbDataURL) data.thumb = tutorialThumbDataURL;
        if(!editId) data.createdAt = Date.now();
        
        if(editId) {
            db.ref('help/tutorials/' + editId).update(data).then(()=>{ alert('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯Ø±Ø³'); adminClearTutorialForm(); }).catch(err=>alert('Ø®Ø·Ø£: '+err.message));
        } else {
            db.ref('help/tutorials').push(data).then(()=>{ alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯Ø±Ø³ Ø¥Ù„Ù‰ Ù…Ø±ÙƒØ² Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª'); adminClearTutorialForm(); }).catch(err=>alert('Ø®Ø·Ø£: '+err.message));
        }
    }

    function adminClearTutorialForm(){
        document.getElementById('editTutorialId').value = '';
        const t = document.getElementById('adminTTitle'); if(t) t.value='';
        const th = document.getElementById('adminTThumb'); if(th) th.value='';
        const c = document.getElementById('adminTContent'); if(c) c.value='';
        const preview = document.getElementById('tutorialThumbPreview'); if(preview) { preview.src=''; preview.style.display='none'; }
        const formTitle = document.getElementById('tutorialFormTitle'); if(formTitle) formTitle.innerText = 'ğŸ“š Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯Ø±ÙˆØ³';
        tutorialThumbDataURL = null;
    }

    // ØªØ­Ù…ÙŠÙ„ ÙˆØ¹Ø±Ø¶ Ø§Ù„Ø¯Ø±ÙˆØ³ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
    function loadAdminTutorials(){
        const list = document.getElementById('adminTutorialsList');
        if(!list) return;
        db.ref('help/tutorials').on('value', snap => {
            const val = snap.val();
            if(!val) { list.innerHTML = '<p style="color:#666;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯Ø±ÙˆØ³ Ø­Ø§Ù„ÙŠØ§Ù‹</p>'; return; }
            const fragment = document.createDocumentFragment();
            Object.keys(val).reverse().forEach(key => {
                const t = val[key];
                const item = document.createElement('div');
                item.className = 'product-item';
                item.innerHTML = `
                    <img src="${t.thumb || 'https://via.placeholder.com/60'}" onerror="this.src='https://via.placeholder.com/60'">
                    <div class="product-info">
                        <strong>${t.title}</strong><br>
                        <small></small>
                    </div>
                    <div class="actions">
                        <button class="btn-edit" onclick="editTutorial('${key}', ${JSON.stringify(t).replace(/"/g, '&quot;')})">ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="btn-delete" onclick="deleteTutorial('${key}')">Ø­Ø°Ù</button>
                    </div>
                `;
                fragment.appendChild(item);
            });
            list.innerHTML = '';
            list.appendChild(fragment);
        });
    }

    function editTutorial(id, data){
        document.getElementById('editTutorialId').value = id;
        document.getElementById('adminTTitle').value = data.title || '';
        document.getElementById('adminTContent').value = data.content || '';
        if(data.thumb) {
            tutorialThumbDataURL = data.thumb;
            const preview = document.getElementById('tutorialThumbPreview');
            preview.src = data.thumb;
            preview.style.display = 'inline-block';
        }
        const formTitle = document.getElementById('tutorialFormTitle');
        if(formTitle) formTitle.innerText = 'âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¯Ø±Ø³';
        window.scrollTo(0, 0);
    }

    function deleteTutorial(id){
        if(confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¯Ø±Ø³ØŸ')){
            db.ref('help/tutorials/' + id).remove().then(()=>alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¯Ø±Ø³')).catch(err=>alert('Ø®Ø·Ø£: '+err.message));
        }
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯Ø±ÙˆØ³ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
    loadAdminTutorials();

    // ========== Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ==========
    async function saveUser() {
        const userId = document.getElementById('editUserId').value;
        const username = (document.getElementById('userName').value || '').trim();
        const password = (document.getElementById('userPassword').value || '').trim();
        const email = (document.getElementById('userEmail').value || '').trim();

        if (!username) {
            alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…');
            return;
        }

        if (!userId && !password) {
            alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯');
            return;
        }

        // Ø¬Ù…Ø¹ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
        const permissions = [];
        document.querySelectorAll('.user-permission:checked').forEach(cb => {
            permissions.push(cb.value);
        });

        const userData = {
            username: username,
            email: email || '',
            permissions: permissions,
            updatedAt: new Date().toISOString()
        };

        // Ø¥Ø¶Ø§ÙØ© createdAt ÙÙ‚Ø· Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯
        if (!userId) {
            userData.createdAt = new Date().toISOString();
        }

        // ØªØ´ÙÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¥Ø°Ø§ ØªÙ… Ø¥Ø¯Ø®Ø§Ù„Ù‡Ø§
        if (password) {
            try {
                const hashedPassword = await hashString(password);
                userData.password = hashedPassword;
            } catch (e) {
                alert('Ø®Ø·Ø£ ÙÙŠ ØªØ´ÙÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±');
                return;
            }
        }

        try {
            if (userId) {
                // ØªØ­Ø¯ÙŠØ« Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯
                await db.ref('admin/users/' + userId).update(userData);
                alert('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­');
            } else {
                // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯
                await db.ref('admin/users').push(userData);
                alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­');
            }
            clearUserForm();
        } catch (err) {
            alert('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ' + err.message);
        }
    }

    function clearUserForm() {
        document.getElementById('editUserId').value = '';
        document.getElementById('userName').value = '';
        document.getElementById('userPassword').value = '';
        document.getElementById('userEmail').value = '';
        document.querySelectorAll('.user-permission').forEach(cb => {
            if (cb.value === 'users') {
                cb.checked = false;
            } else {
                cb.checked = true;
            }
        });
        const formTitle = document.getElementById('userFormTitle');
        if (formTitle) formTitle.innerText = 'ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†';
        const saveBtn = document.getElementById('saveUserBtn');
        if (saveBtn) saveBtn.innerText = 'Ø­ÙØ¸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…';
    }

    function loadUsers() {
        const list = document.getElementById('usersList');
        if (!list) return;
        
        db.ref('admin/users').on('value', snap => {
            const val = snap.val();
            if (!val) {
                list.innerHTML = '<p style="color:#666;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹</p>';
                return;
            }
            
            const fragment = document.createDocumentFragment();
            Object.keys(val).forEach(key => {
                const user = val[key];
                const item = document.createElement('div');
                item.className = 'product-item';
                
                const permissionsText = (user.permissions || []).length > 0 
                    ? user.permissions.join(', ') 
                    : 'Ø¨Ø¯ÙˆÙ† ØµÙ„Ø§Ø­ÙŠØ§Øª';
                
                item.innerHTML = `
                    <div style="width:60px;height:60px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);border-radius:50%;display:flex;align-items:center;justify-content:center;color:white;font-size:24px;font-weight:bold;">
                        ${user.username.charAt(0).toUpperCase()}
                    </div>
                    <div class="product-info">
                        <strong>${user.username}</strong><br>
                        <small>ğŸ“§ ${user.email || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨Ø±ÙŠØ¯'}</small><br>
                        <small style="color:#007bff;">ğŸ” ${permissionsText}</small>
                    </div>
                    <div class="actions">
                        <button class="btn-edit" onclick="editUser('${key}')">ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="btn-delete" onclick="deleteUser('${key}')">Ø­Ø°Ù</button>
                    </div>
                `;
                fragment.appendChild(item);
            });
            list.innerHTML = '';
            list.appendChild(fragment);
        });
    }

    function editUser(userId) {
        db.ref('admin/users/' + userId).once('value').then(snap => {
            const user = snap.val();
            if (!user) return;
            
            document.getElementById('editUserId').value = userId;
            document.getElementById('userName').value = user.username || '';
            document.getElementById('userEmail').value = user.email || '';
            document.getElementById('userPassword').value = ''; // Ù„Ø§ Ù†Ø¹Ø±Ø¶ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
            
            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
            document.querySelectorAll('.user-permission').forEach(cb => {
                cb.checked = (user.permissions || []).includes(cb.value);
            });
            
            const formTitle = document.getElementById('userFormTitle');
            if (formTitle) formTitle.innerText = 'âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù…';
            const saveBtn = document.getElementById('saveUserBtn');
            if (saveBtn) saveBtn.innerText = 'Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª';
            
            window.scrollTo(0, 0);
        });
    }

    function deleteUser(userId) {
        if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ Ù„Ù† ÙŠØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù.')) {
            db.ref('admin/users/' + userId).remove()
                .then(() => alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­'))
                .catch(err => alert('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø°Ù: ' + err.message));
        }
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
    loadUsers();
    
    // ÙØ­Øµ Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    checkLoginStatus();
</script>
</body>
</html>